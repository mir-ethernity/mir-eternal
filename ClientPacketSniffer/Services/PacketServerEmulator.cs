using ClientPacketSniffer.Repositories;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Sockets;
using System.Text;
using System.Threading.Tasks;

namespace ClientPacketSniffer.Services
{
    public class PacketServerEmulator
    {
        public static PacketServerEmulator Instance { get; } = new PacketServerEmulator();

        static PacketServerEmulator()
        {
            byte[] ProtocolKey1 = Convert.FromBase64String("MzUyNjM1MTk4MAA4MAA6MjU6YWE6M2Y6MjI6MDYAVUxTMjEtMTA5NmRiNTViMGVlNDBiNGJkZjMxYjFmZTVjYmYBgW4GAAAHAAAA");
            byte[] ProtocolKey2 = Convert.FromBase64String("MjAxNi0wMi0yNgA=");
            byte[] ProtocolKey3 = Convert.FromBase64String("eJztVs1qFEEQ7u35W/dnZl2jQSIajGzEaFCUCHoQJeTgzXhWPHjzLQTF5/DixWfQg2/ixYs3HyBW7Xyf822TREQxly0oqru6/rurZkIIoR+Oh9rwAPBR1kNbX5Y9ocxC2O+FUOLM7ZeHyDkUR5w577RhNFw1HCDOBvIj4Bhyfj7BfgzZCngXObj8CnxVoG+gd8/wGXiu77ldERuO2/BdwV4Jv2OR2YJv5z83tFKEU4Y55AucnZecL8BGARsl9GrJW2s0ELkyWZ+FjtNz0BmAXjQ6hR/qsdZ5cgdRdHPE5/XbFVmtsdv4knV+aOcM1iPUtAL1/DYlhiH4pSD917JmzSlTIJ5KYsogU0kcMbY5ZEDGTdn1pL5OG9SL9+C8W3L3rJOf7YhOhZiGEjf1GT+R70JzWpX1VGKsRa6Wc+ZZ4TwCnUf9mbwrYimyvr8kdzkAbwLqMn3JOSa6Ebnk2DeyzyVO5jK3U7T3lyW1Z55pzUiZO/OfYt2/2unpG9oQO1qDRt4C/b+09ZrhnbDYH4yN8fNuNfZa6k4/elcPDa9LfpT1/YfYxjOS+PeQ2zV5B+xV3p3LLmEJfwOPwuKM87d1A3trqXkv3A5tP3zKW9mt0PXEJtb7WLv+DKh9NxAd9o72HmdY+RscHcGPx/CrZO++3seuN+tE52Zo5wBj+hYWZwHldkAfGG6Ibf0ucmbobKKNWejmYpHUgn3u34NXouewFrrvjPN9dgwFOad1Ns1npNT81xzqtfRd7GbqEDVpEhsHCehsJO+z5Pk1tP+I3HO+vU30nO4m9v1++O3asxi3bX9/3db2IB8b70dvsSaTpEZaZ6ffTX8la2WehiUsYQn/A8oT8utz7fUJ+f6XwLnrdXxi8+tFOPy753My+wO7PwHpSume9AMA");

            byte[] Protocol = ProtocolKey1.Concat(ProtocolKey2).Concat(ProtocolKey3).ToArray();

            Instance
                // Login Success
                .OnReceivePacket(
                    1001,
                    (p) => p.ReplyWith(1002, new byte[761] { 51, 53, 50, 54, 51, 53, 49, 57, 56, 48, 0, 56, 48, 0, 58, 50, 53, 58, 97, 97, 58, 51, 102, 58, 50, 50, 58, 48, 54, 0, 85, 76, 83, 50, 49, 45, 53, 53, 51, 50, 101, 48, 54, 57, 50, 100, 50, 51, 52, 98, 98, 48, 57, 97, 56, 98, 99, 50, 100, 102, 100, 102, 57, 97, 51, 1, 129, 110, 6, 0, 0, 7, 0, 0, 0, 50, 48, 49, 54, 45, 48, 50, 45, 50, 54, 0, 120, 156, 237, 86, 205, 106, 20, 65, 16, 238, 237, 249, 91, 247, 103, 102, 93, 163, 65, 34, 26, 140, 108, 196, 104, 80, 148, 8, 122, 16, 37, 228, 224, 205, 120, 86, 60, 120, 243, 45, 4, 197, 231, 240, 226, 197, 103, 208, 131, 111, 226, 197, 139, 55, 31, 32, 86, 237, 124, 159, 243, 109, 147, 68, 68, 49, 151, 45, 40, 170, 187, 186, 254, 187, 171, 102, 66, 8, 161, 31, 142, 135, 218, 240, 0, 240, 81, 214, 67, 91, 95, 150, 61, 161, 204, 66, 216, 239, 133, 80, 226, 204, 237, 151, 135, 200, 57, 20, 71, 156, 57, 239, 180, 97, 52, 92, 53, 28, 32, 206, 6, 242, 35, 224, 24, 114, 126, 62, 193, 126, 12, 217, 10, 120, 23, 57, 184, 252, 10, 124, 85, 160, 111, 160, 119, 207, 240, 25, 120, 174, 239, 185, 93, 17, 27, 142, 219, 240, 93, 193, 94, 9, 191, 99, 145, 217, 130, 111, 231, 63, 55, 180, 82, 132, 83, 134, 57, 228, 11, 156, 157, 151, 156, 47, 192, 70, 1, 27, 37, 244, 106, 201, 91, 107, 52, 16, 185, 50, 89, 159, 133, 142, 211, 115, 208, 25, 128, 94, 52, 58, 133, 31, 234, 177, 214, 121, 114, 7, 81, 116, 115, 196, 231, 245, 219, 21, 89, 173, 177, 219, 248, 146, 117, 126, 104, 231, 12, 214, 35, 212, 180, 2, 245, 252, 54, 37, 134, 33, 248, 165, 32, 253, 215, 178, 102, 205, 41, 83, 32, 158, 74, 98, 202, 32, 83, 73, 28, 49, 182, 57, 100, 64, 198, 77, 217, 245, 164, 190, 78, 27, 212, 139, 247, 224, 188, 91, 114, 247, 172, 147, 159, 237, 136, 78, 133, 152, 134, 18, 55, 245, 25, 63, 145, 239, 66, 115, 90, 149, 245, 84, 98, 172, 69, 174, 150, 115, 230, 89, 225, 60, 2, 157, 71, 253, 153, 188, 43, 98, 41, 178, 190, 191, 36, 119, 57, 0, 111, 2, 234, 50, 125, 201, 57, 38, 186, 17, 185, 228, 216, 55, 178, 207, 37, 78, 230, 50, 183, 83, 180, 247, 151, 37, 181, 103, 158, 105, 205, 72, 153, 59, 243, 159, 98, 221, 191, 218, 233, 233, 27, 218, 16, 59, 90, 131, 70, 222, 2, 253, 191, 180, 245, 154, 225, 157, 176, 216, 31, 140, 141, 241, 243, 110, 53, 246, 90, 234, 78, 63, 122, 87, 15, 13, 175, 75, 126, 148, 245, 253, 135, 216, 198, 51, 146, 248, 247, 144, 219, 53, 121, 7, 236, 85, 222, 157, 203, 46, 97, 9, 127, 3, 143, 194, 226, 140, 243, 183, 117, 3, 123, 107, 169, 121, 47, 220, 14, 109, 63, 124, 202, 91, 217, 173, 208, 245, 196, 38, 214, 251, 88, 187, 254, 12, 168, 125, 55, 16, 29, 246, 142, 246, 30, 103, 88, 249, 27, 28, 29, 193, 143, 199, 240, 171, 100, 239, 190, 222, 199, 174, 55, 235, 68, 231, 102, 104, 231, 0, 99, 250, 22, 22, 103, 1, 229, 118, 64, 31, 24, 110, 136, 109, 253, 46, 114, 102, 232, 108, 162, 141, 89, 232, 230, 98, 145, 212, 130, 125, 238, 223, 131, 87, 162, 231, 176, 22, 186, 239, 140, 243, 125, 118, 12, 5, 57, 167, 117, 54, 205, 103, 164, 212, 252, 215, 28, 234, 181, 244, 93, 236, 102, 234, 16, 53, 105, 18, 27, 7, 9, 232, 108, 36, 239, 179, 228, 249, 53, 180, 255, 136, 220, 115, 190, 189, 77, 244, 156, 238, 38, 246, 253, 126, 248, 237, 218, 179, 24, 183, 109, 127, 127, 221, 214, 246, 32, 31, 27, 239, 71, 111, 177, 38, 147, 164, 70, 90, 103, 167, 223, 77, 127, 37, 107, 101, 158, 134, 37, 44, 97, 9, 255, 3, 202, 19, 242, 235, 115, 237, 245, 9, 249, 254, 151, 192, 185, 235, 117, 124, 98, 243, 235, 69, 56, 252, 187, 231, 115, 50, 251, 3, 187, 63, 1, 233, 74, 233, 158 })
                        .ReplyWith(1012, new byte[1] { 0 })
                        //.ReplyWith(691, new byte[14] { 100, 0, 130, 0, 160, 0, 190, 0, 220, 0, 250, 0, 250, 0 })
                        //.ReplyWith(692, new byte[4] { 0, 0, 0, 0 })
                        .ReplyWith(1004, new byte[847] { 2, 46, 23, 53, 0, 112, 101, 114, 105, 99, 111, 0, 0, 0, 0, 0, 58, 50, 53, 58, 97, 97, 58, 51, 102, 58, 50, 50, 58, 48, 54, 0, 85, 76, 83, 50, 49, 0, 53, 53, 51, 50, 101, 48, 54, 57, 50, 100, 50, 51, 52, 98, 98, 48, 57, 97, 56, 98, 99, 50, 100, 102, 1, 1, 1, 0, 0, 0, 18, 143, 0, 0, 0, 0, 105, 90, 244, 5, 25, 148, 245, 5, 0, 0, 0, 0, 44, 227, 230, 98, 0, 0, 0, 0, 20, 35, 26, 53, 0, 99, 97, 122, 97, 0, 93, 163, 65, 34, 26, 140, 108, 196, 104, 80, 148, 8, 122, 16, 37, 228, 224, 205, 120, 86, 60, 120, 243, 45, 4, 197, 231, 0, 226, 197, 103, 208, 131, 111, 226, 197, 139, 55, 31, 32, 86, 237, 124, 159, 243, 109, 147, 68, 68, 49, 151, 45, 1, 2, 0, 0, 0, 0, 1, 142, 0, 0, 0, 0, 0, 0, 0, 0, 225, 35, 93, 5, 0, 0, 0, 0, 194, 174, 230, 98, 0, 0, 0, 0, 226, 204, 237, 151, 135, 200, 57, 20, 71, 156, 57, 239, 180, 97, 52, 92, 53, 28, 32, 206, 6, 242, 35, 224, 24, 114, 126, 62, 193, 126, 12, 217, 10, 120, 23, 57, 184, 252, 10, 124, 85, 160, 111, 160, 119, 207, 240, 25, 120, 174, 239, 185, 93, 17, 27, 142, 219, 240, 93, 193, 94, 9, 191, 99, 145, 217, 130, 111, 231, 63, 55, 180, 82, 132, 83, 134, 57, 228, 11, 156, 157, 151, 156, 47, 192, 70, 1, 27, 37, 244, 106, 201, 91, 107, 52, 16, 185, 50, 89, 159, 133, 142, 211, 115, 208, 25, 128, 94, 52, 58, 133, 31, 234, 177, 214, 121, 114, 7, 81, 116, 115, 196, 231, 245, 219, 21, 89, 173, 177, 219, 248, 146, 117, 126, 104, 231, 12, 214, 35, 212, 180, 2, 245, 252, 54, 37, 134, 33, 248, 165, 32, 253, 215, 178, 102, 205, 41, 83, 32, 158, 74, 98, 202, 32, 83, 73, 28, 49, 182, 57, 100, 64, 198, 77, 217, 245, 164, 190, 78, 27, 212, 139, 247, 224, 188, 91, 114, 247, 172, 147, 159, 237, 136, 78, 133, 152, 134, 18, 55, 245, 25, 63, 145, 239, 66, 115, 90, 149, 245, 84, 98, 172, 69, 174, 150, 115, 230, 89, 225, 60, 2, 157, 71, 253, 153, 188, 43, 98, 41, 178, 190, 191, 36, 119, 57, 0, 111, 2, 234, 50, 125, 201, 57, 38, 186, 17, 185, 228, 216, 55, 178, 207, 37, 78, 230, 50, 183, 83, 180, 247, 151, 37, 181, 103, 158, 105, 205, 72, 153, 59, 243, 159, 98, 221, 191, 218, 233, 233, 27, 218, 16, 59, 90, 131, 70, 222, 2, 253, 191, 180, 245, 154, 225, 157, 176, 216, 31, 140, 141, 241, 243, 110, 53, 246, 90, 234, 78, 63, 122, 87, 15, 13, 175, 75, 126, 148, 245, 253, 135, 216, 198, 51, 146, 248, 247, 144, 219, 53, 121, 7, 236, 85, 222, 157, 203, 46, 97, 9, 127, 3, 143, 194, 226, 140, 243, 183, 117, 3, 123, 107, 169, 121, 47, 220, 14, 109, 63, 124, 202, 91, 217, 173, 208, 245, 196, 38, 214, 251, 88, 187, 254, 12, 168, 125, 55, 16, 29, 246, 142, 246, 30, 103, 88, 249, 27, 28, 29, 193, 143, 199, 240, 171, 100, 239, 190, 222, 199, 174, 55, 235, 68, 231, 102, 104, 231, 0, 99, 250, 22, 22, 103, 1, 229, 118, 64, 31, 24, 110, 136, 109, 253, 46, 114, 102, 232, 108, 162, 141, 89, 232, 230, 98, 145, 212, 130, 125, 238, 223, 131, 87, 162, 231, 176, 22, 186, 239, 140, 243, 125, 118, 12, 5, 57, 167, 117, 54, 205, 103, 164, 212, 252, 215, 28, 234, 181, 244, 93, 236, 102, 234, 16, 53, 105, 18, 27, 7, 9, 232, 108, 36, 239, 179, 228, 249, 53, 180, 255, 136, 220, 115, 190, 189, 77, 244, 156, 238, 38, 246, 253, 126, 248, 237, 218, 179, 24, 183, 109, 127, 127, 221, 214, 246, 32, 31, 27, 239, 71, 111, 177, 38, 147, 164, 70, 90, 103, 167, 223, 77, 127, 37, 107, 101, 158, 134, 37, 44, 97, 9, 255, 3, 202, 19, 242, 235, 115, 237, 245, 9, 249, 254, 151, 192, 185, 235, 117, 124, 98, 243, 235, 69, 56, 252, 187, 231, 115, 50, 251, 3, 187, 63, 1, 233, 74, 233, 158, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 180, 232, 175, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 139, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129 })
                )
                // Select a character to enter a game
                .OnReceivePacket(
                    1006,
                    (p) => p.ReplyWith(1003, new byte[4] { 35, 26, 53, 0 })
                    //.ReplyWith(529, new byte[] { 0, 26, 53, 0, 0, 0, 0, 0, 1, 0, 0, 1, 142, 0, 0, 0, 35, 26, 53, 0, 0, 0, 0, 0, 181, 0, 0, 0, 72, 0, 0, 0, 225, 4, 0, 0, 176 })
                    //.ReplyWith(577, new byte[4] { 0, 0, 0, 0 })
                    //.ReplyWith(662, new byte[8] { 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(701, new byte[4] { 0, 0, 0, 0 })
                    //.ReplyWith(664, new byte[224] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(702, new byte[81] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(9, new byte[12] { 145, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(365, new byte[2] { 0, 0 })
                    //.ReplyWith(187, new byte[11] { 1, 171, 3, 35, 26, 53, 0, 13, 0, 0, 0 })
                    .ReplyWith(12, new byte[170] { 35, 26, 53, 0, 142, 0, 0, 0, 1, 0, 0, 1, 1, 2, 1, 2, 0, 0, 0, 0, 255, 0, 0, 32, 0, 5, 32, 14, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 147, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 72, 0, 0, 0, 48, 105, 176, 56, 176, 4, 0, 24, 1, 0, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 103, 182, 231, 98, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 37, 207, 86, 60, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 136, 19 })

                    //.ReplyWith(29, new byte[3216] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 142, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 250, 134, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 205, 229, 230, 98, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 250, 134, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(18, new byte[] { 24, 4, 0, 0, 0, 0, 226, 9, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0, 236, 17, 0, 0, 0, 0 })
                    //.ReplyWith(16, new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(148, new byte[961] { 1, 0, 0, 0, 0, 0, 0, 0, 0, 64, 75, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 201, 154, 59, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 160, 134, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, 150, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 150, 152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 160, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 208, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 150, 152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 160, 134, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 66, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 32, 78, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 165, 212, 232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 225, 245, 5, 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(15, new byte[] { 16, 32, 16, 0, 0, 2, 1, 32, 16 })
                    //.ReplyWith(17, new byte[] { 1, 7, 14, 9, 16, 66, 0, 137, 30, 228, 98, 225, 35, 93, 5, 0, 1, 136, 19, 0, 0, 136, 19, 0, 0, 10, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 14, 3, 16, 66, 0, 137, 30, 228, 98, 75, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 14, 4, 16, 66, 0, 137, 30, 228, 98, 75, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 14, 5, 16, 66, 0, 137, 30, 228, 98, 75, 1, 0, 0, 1, 2, 1, 0, 0, 0, 1, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 14, 6, 16, 66, 0, 137, 30, 228, 98, 75, 1, 0, 0, 1, 3, 1, 0, 0, 0, 1, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 14, 7, 16, 66, 0, 137, 30, 228, 98, 75, 1, 0, 0, 1, 4, 1, 0, 0, 0, 1, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 14, 8, 16, 66, 0, 137, 30, 228, 98, 225, 195, 91, 5, 1, 5, 160, 15, 0, 0, 160, 15, 0, 0, 10, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(323, new byte[] { 0, 8, 0, 0, 16, 66, 0, 137, 30, 228, 98, 225, 35, 93, 5, 0, 0, 136, 19, 0, 0, 136, 19, 0, 0, 10, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 14, 3, 16, 0, 0, 137, 30, 228, 98, 75, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 14, 4, 16, 66, 0, 137, 30, 228, 98, 75, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 14, 5, 16, 66, 0, 137, 30, 228, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                    // .ReplyWith(78, new byte[] { 35, 26, 53, 0, 16, 0, 0, 0, 16, 0, 0, 0 })
                    // este paquete activa las quests
                    .ReplyWith(20, new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 194, 174, 230, 98, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 199, 133, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 161, 5, 0, 0, 137, 30, 228, 98, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(170, new byte[] { 0, 0, 0, 0, 0, 0, 0, 0 })
                    //.ReplyWith(170, new byte[] { 0, 0, 0, 0, 1, 0, 0, 0 })
                    //.ReplyWith(169, new byte[] { 0, 0, 0, 0, 6, 0, 0, 0, 6, 0, 0, 0 })
                    //.ReplyWith(169, new byte[] { 1, 0, 0, 0, 3, 0, 0, 0, 10, 0, 0, 0 })
                    //.ReplyWith(22, new byte[] { 196, 79, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 2, 240, 216, 0, 203, 3, 1, 0, 128, 51, 4, 1, 0, 0, 0, 5, 1, 0, 0, 0, 6, 240, 216, 0, 0, 7, 240, 216, 67, 0, 8, 1, 0, 105, 16, 9, 240, 216, 0, 0, 10, 240, 216, 0, 0, 11, 1, 0, 0, 0, 12, 240, 216, 0, 255, 13, 240, 216, 0, 0, 14, 1, 0, 0, 0, 15, 240, 216, 0, 0, 16, 1, 0, 0, 0, 17, 1, 0, 0, 0, 18, 1, 0, 0, 0, 19, 240, 216, 228, 230, 20, 240, 216, 0, 0, 21, 240, 216, 0, 0, 22, 240, 216, 207, 86, 23, 1, 0, 0, 1, 24, 240, 216, 0, 0, 25, 1, 0, 0, 0, 26, 1, 0, 0, 0, 27, 240, 216, 0, 0, 28, 1, 0, 0, 0, 29, 240, 216, 0, 0, 30, 1, 0, 120, 99, 31, 240, 216, 229, 113, 32, 240, 216, 100, 241, 33, 1, 0, 248, 114, 34, 240, 216, 22, 121, 35, 240, 216, 89, 247, 36, 1, 0, 23, 200, 37, 240, 216, 94, 147, 38, 240, 216, 127, 181, 39, 1, 0, 149, 145, 40, 1, 0, 158, 161, 41, 1, 0, 113, 110, 42, 1, 0, 11, 2, 43, 1, 0, 197, 121, 44, 1, 0, 191, 34, 45, 240, 216, 1, 62, 46, 240, 216, 44, 25, 47, 240, 216, 134, 5, 48, 1, 0, 226, 136, 49, 240, 216, 48, 80, 50, 240, 216, 138, 35, 51, 1, 0, 149, 190, 52, 240, 216, 144, 144, 53, 1, 0, 83, 7, 54, 240, 216, 165, 52, 55, 240, 216, 213, 155, 56, 240, 216, 153, 176, 57, 1, 0, 99, 165, 58, 1, 0, 205, 158, 59, 240, 216, 24, 171, 60, 240, 216, 245, 84, 61, 240, 216, 136, 136, 62, 240, 216, 80, 128, 63, 1, 0 })
                    //.ReplyWith(19, new byte[] { 0, 226, 9, 0, 1, 0, 0, 0, 2, 0, 0, 0, 3, 0, 0, 0, 4, 0, 0, 0, 5, 0, 0, 0, 6, 236, 17, 0, 7, 0, 0, 0, 8, 24, 4, 0, 9, 0, 10, 0, 10, 0, 0, 0, 11, 0, 0, 0, 12, 0, 0, 0, 13, 0, 0, 0, 14, 0, 0, 0, 15, 0, 0, 0, 16, 0, 0, 0, 17, 0, 0, 0, 18, 0, 0, 0, 19, 0, 0, 0, 20, 0, 0, 0, 21, 0, 0, 0, 22, 0, 0, 0, 23, 0, 0, 0, 24, 0, 0, 0, 25, 0, 0, 0, 26, 0, 0, 0, 27, 0, 0, 0, 28, 0, 0, 0, 29, 0, 0, 0, 30, 0, 0, 0, 31, 0, 0, 0 })
                    //.ReplyWith(207, new byte[] { 1, 0 })

                    //.ReplyWith(23, new byte[] { 0, 0, 0, 0 })
                 // en este paquete se muestra la scena, cambiando el byte 9 se muestra el video ( confirmar si es un int o un short )
                 .ReplyWith(185, new byte[] { 50, 0, 0, 14, 0, 0, 132, 0, 1, 0, 0, 0, 244, 1, 142, 0, 0, 0, 25, 3, 1, 0, 0, 0, 171, 3, 13, 0, 0, 0 })
                // .ReplyWith(24, new byte[] { 0, 0 })
                // .ReplyWith(25, new byte[] { 0, 0, 0, 0, 0, 1 })
                // .ReplyWith(26, new byte[] { 0, 0, 0, 0 })
                // .ReplyWith(227, new byte[] { 0, 0, 0, 0 })
                // .ReplyWith(186, new byte[] { 1, 14, 3, 189, 0, 0, 0, 0, 2, 0, 0, 24, 4, 2, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 128, 54, 11, 128, 53, 10, 128, 52, 9, 128, 51, 8, 128, 50, 7, 128, 49, 6, 128, 117, 5, 128, 116, 4, 128, 115, 3, 128, 114, 2, 128, 113, 1, 128, 112, 0, 128, 121, 18, 128, 120, 19, 128, 122, 20, 128, 86, 70, 128, 76, 22, 128, 74, 23, 128, 71, 24, 128, 88, 25, 128, 79, 26, 128, 84, 27, 128, 78, 28, 128, 85, 29, 128, 89, 30, 128, 75, 31, 128, 65, 32, 128, 73, 33, 128, 80, 34, 128, 68, 68, 128, 69, 39, 128, 123, 40, 128, 70, 36, 128, 77, 37, 128, 9, 38, 128, 27, 41, 129, 72, 42, 130, 88, 43, 130, 87, 44, 130, 69, 45, 129, 70, 46, 129, 67, 47, 129, 83, 48, 129, 73, 49, 129, 65, 50, 128, 144, 51, 128, 67, 52, 128, 87, 53, 128, 90, 73, 128, 37, 54, 128, 100, 55, 128, 38, 58, 128, 104, 59, 128, 39, 56, 128, 102, 57, 128, 40, 60, 128, 98, 61, 128, 101, 62, 128, 103, 63, 128, 105, 64, 128, 97, 65, 128, 99, 66, 128, 55, 12, 128, 56, 13, 128, 57, 14, 128, 48, 15, 128, 189, 16, 128, 187, 17, 128, 83, 67, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 81, 69, 128, 66, 71, 128, 72, 72, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0 })
                // .ReplyWith(248, new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                // .ReplyWith(28, new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                // .ReplyWith(30, new byte[] { 0, 0 })
                //.ReplyWith(21, new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 35, 26, 53, 0 })
                //.ReplyWith(32, new byte[] { 0, 0, 0 })
                //.ReplyWith(301, new byte[] { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                //.ReplyWith(335, new byte[] { 0, 3, 0, 0, 10, 0 })
                //.ReplyWith(68, new byte[] { 0 })
                //.ReplyWith(288, new byte[] { 0, 1, 0 })
                //.ReplyWith(365, new byte[] { 0, 0 })
                //.ReplyWith(33, new byte[] { 35, 26, 53, 0 })
                //.ReplyWith(280, new byte[] { 0, 0 })
                //.ReplyWith(14, new byte[714] { 53, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 3, 2, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 5, 1, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 7, 1, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 9, 1, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 11, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 13, 0, 0, 0, 0, 0, 0, 14, 0, 0, 0, 0, 0, 0, 15, 0, 0, 0, 0, 0, 0, 16, 16, 0, 0, 0, 0, 0, 17, 18, 0, 0, 0, 0, 0, 18, 8, 0, 0, 0, 0, 0, 19, 12, 0, 0, 0, 0, 0, 20, 7, 0, 0, 0, 0, 0, 21, 15, 0, 0, 0, 0, 0, 22, 232, 3, 0, 0, 0, 0, 23, 0, 0, 0, 0, 0, 0, 24, 0, 0, 0, 0, 0, 0, 25, 0, 0, 0, 0, 0, 0, 26, 0, 0, 0, 0, 0, 0, 27, 0, 0, 0, 0, 0, 0, 28, 0, 0, 0, 0, 0, 0, 29, 0, 0, 0, 0, 0, 0, 30, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 33, 0, 0, 0, 0, 0, 0, 34, 0, 0, 0, 0, 0, 0, 35, 0, 0, 0, 0, 0, 0, 36, 0, 0, 0, 0, 0, 0, 37, 75, 0, 0, 0, 0, 0, 38, 18, 0, 0, 0, 0, 0, 39, 44, 1, 0, 0, 0, 0, 40, 32, 3, 0, 0, 0, 0, 41, 50, 0, 0, 0, 0, 0, 42, 16, 39, 0, 0, 0, 0, 43, 0, 0, 0, 0, 0, 0, 44, 0, 0, 0, 0, 0, 0, 45, 0, 0, 0, 0, 0, 0, 46, 0, 0, 0, 0, 0, 0, 47, 0, 0, 0, 0, 0, 0, 48, 0, 0, 0, 0, 0, 0, 49, 0, 0, 0, 0, 0, 0, 50, 12, 0, 0, 0, 0, 0, 51, 24, 0, 0, 0, 0, 0, 52, 60, 0, 0, 0, 0, 0, 53, 0, 0, 0, 0, 0, 0, 54, 0, 0, 0, 0, 0, 0, 55, 0, 0, 0, 0, 0, 0, 56, 0, 0, 0, 0, 0, 0, 57, 0, 0, 0, 0, 0, 0, 58, 0, 0, 0, 0, 0, 0, 59, 0, 0, 0, 0, 0, 0, 60, 0, 0, 0, 0, 0, 0, 61, 0, 0, 0, 0, 0, 0, 62, 0, 0, 0, 0, 0, 0, 63, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 65, 0, 0, 0, 0, 0, 0, 66, 16, 39, 0, 0, 0, 0, 67, 0, 0, 0, 0, 0, 0, 68, 0, 0, 0, 0, 0, 0, 69, 0, 0, 0, 0, 0, 0, 70, 0, 0, 0, 0, 0, 0, 71, 0, 0, 0, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 73, 0, 0, 0, 0, 0, 0, 74, 0, 0, 0, 0, 0, 0, 75, 0, 0, 0, 0, 0, 0, 76, 0, 0, 0, 0, 0, 0, 77, 0, 0, 0, 0, 0, 0, 78, 0, 0, 0, 0, 0, 0, 79, 0, 0, 0, 0, 0, 0, 80, 0, 0, 0, 0, 0, 0, 81, 0, 0, 0, 0, 0, 0, 82, 0, 0, 0, 0, 0, 0, 83, 0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 85, 0, 0, 0, 0, 0, 0, 86, 0, 0, 0, 0, 0, 0, 87, 0, 0, 0, 0, 0, 0, 88, 0, 0, 0, 0, 0, 0, 89, 0, 0, 0, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 91, 0, 0, 0, 0, 0, 0, 92, 0, 0, 0, 0, 0, 0, 93, 0, 0, 0, 0, 0, 0, 94, 0, 0, 0, 0, 0, 0, 95, 0, 0, 0, 0, 0, 0, 96, 0, 0, 0, 0, 0, 0, 97, 0, 0, 0, 0, 0, 0, 98, 0, 0, 0, 0, 0, 0, 99, 0, 0, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 101, 0, 0, 0, 0 })
                //.ReplyWith(352, new byte[] { 0, 0, 0, 0 })
                //.ReplyWith(120, new byte[] { 50, 10, 1, 0, 0, 35, 1, 232, 3, 0, 0, 232, 3, 0, 0 })
                //.ReplyWith(314, new byte[] { 0, 0 })
                //.ReplyWith(108, new byte[] { 0, 0 })
                //.ReplyWith(296, new byte[] { 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 2, 0, 0, 2, 0, 0, 0, 2, 1, 0, 0, 2, 2, 0, 0, 3, 0, 0, 0, 3, 1, 0, 0, 3, 2, 0, 0, 4, 0, 0, 0, 4, 1, 0, 0, 4, 2, 0, 0, 5, 0, 0, 0, 5, 1, 0, 0, 5, 2, 0, 0, 6, 0, 0, 0, 6, 1, 0, 0, 6, 2, 0, 0, 7, 0, 0, 0, 7, 1, 0, 0, 7, 2, 0, 0, 8, 0, 0, 0, 8, 1, 0, 0, 8, 2, 0, 0, 9, 0, 0, 0, 9, 1, 0, 0, 9, 2, 0, 0, 10, 0, 0, 0, 10, 1, 0, 0, 10, 2, 0, 0, 11, 0, 0, 0, 11, 1, 0, 0, 11, 2, 0, 0, 12, 0, 0, 0, 12, 1, 0, 0, 12, 2, 0, 0, 13, 0, 0, 0, 13, 1, 0, 0, 13, 2, 0, 0, 14, 0, 0, 0, 14, 1, 0, 0, 14, 2, 0, 0, 15, 0, 0, 0, 15, 1, 0, 0, 15, 2, 0, 0, 16, 0, 0, 0, 16, 1, 0, 0, 16, 2, 0, 0, 17, 0, 0, 0, 17, 1, 0, 0, 17, 2, 0, 0, 18, 0, 0, 0, 18, 1, 0, 0, 18, 2, 0, 0, 19, 0, 0, 0, 19, 1, 0, 0, 19, 2 })
                //.ReplyWith(322, new byte[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 })
                //.ReplyWith(359, new byte[] { 35, 26, 53, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255 })
                )
                // Test gateway network speed
                .OnReceivePacket(
                    1007,
                    (p) => p.ReplyWith(1010, new byte[] { 115, 224, 1, 10 })
                )
                // Customer Internet Speed Test
                .OnReceivePacket(
                    23,
                    (p) => p.ReplyWith(45, new byte[] { 115, 224, 1, 10 })
                )
                // Object rotate
                .OnReceivePacket(
                    16,
                    (p) => p.ReplyWith(50, new byte[] { 35, 26, 53, 0 }.Concat(p.Answer.Data.Take(2).ToArray()).ToArray())
                )
                // Battle stance
                .OnReceivePacket(
                    40,
                    (p) => { }
                )
                // Upload social media
                .OnReceivePacket(
                    525,
                    (p) => { }
                )
                // Upload game settings
                .OnReceivePacket(
                    137,
                    (p) => { }
                )
                // Unknown C1
                .OnReceivePacket(
                    642,
                    (p) => { }
                )
                // Unknown C2
                .OnReceivePacket(
                    644,
                    (p) => { }
                )
                // ReservedPacketZeroTwoPacket
                .OnReceivePacket(
                    187,
                    (p) => { }
                )
                // RequestObjectDataPacket
                .OnReceivePacket(
                    19,
                    (p) => { }
                )
                // Skip plot animation
                .OnReceivePacket(
                    25,
                    (p) => { }
                )
                // Change character
                .OnReceivePacket(
                    10,
                    (p) => p.ReplyWith(279, new byte[] { 1, 0 })
                        .ReplyWith(1009, new byte[] { })
                        .ReplyWith(1004, new byte[847] { 2, 46, 23, 53, 0, 112, 101, 114, 105, 99, 111, 0, 0, 56, 48, 0, 58, 50, 53, 58, 97, 97, 58, 51, 102, 58, 50, 50, 58, 48, 54, 0, 85, 76, 83, 50, 49, 0, 53, 53, 51, 50, 101, 48, 54, 57, 50, 100, 50, 51, 52, 98, 98, 48, 57, 97, 56, 98, 99, 50, 100, 102, 1, 1, 1, 0, 0, 0, 18, 143, 0, 0, 0, 0, 105, 90, 244, 5, 25, 148, 245, 5, 0, 0, 0, 0, 44, 227, 230, 98, 0, 0, 0, 0, 20, 35, 26, 53, 0, 99, 97, 122, 97, 0, 93, 163, 65, 34, 26, 140, 108, 196, 104, 80, 148, 8, 122, 16, 37, 228, 224, 205, 120, 86, 60, 120, 243, 45, 4, 197, 231, 0, 226, 197, 103, 208, 131, 111, 226, 197, 139, 55, 31, 32, 86, 237, 124, 159, 243, 109, 147, 68, 68, 49, 151, 45, 1, 2, 0, 0, 0, 0, 1, 142, 0, 0, 0, 0, 0, 0, 0, 0, 225, 35, 93, 5, 0, 0, 0, 0, 194, 174, 230, 98, 0, 0, 0, 0, 226, 204, 237, 151, 135, 200, 57, 20, 71, 156, 57, 239, 180, 97, 52, 92, 53, 28, 32, 206, 6, 242, 35, 224, 24, 114, 126, 62, 193, 126, 12, 217, 10, 120, 23, 57, 184, 252, 10, 124, 85, 160, 111, 160, 119, 207, 240, 25, 120, 174, 239, 185, 93, 17, 27, 142, 219, 240, 93, 193, 94, 9, 191, 99, 145, 217, 130, 111, 231, 63, 55, 180, 82, 132, 83, 134, 57, 228, 11, 156, 157, 151, 156, 47, 192, 70, 1, 27, 37, 244, 106, 201, 91, 107, 52, 16, 185, 50, 89, 159, 133, 142, 211, 115, 208, 25, 128, 94, 52, 58, 133, 31, 234, 177, 214, 121, 114, 7, 81, 116, 115, 196, 231, 245, 219, 21, 89, 173, 177, 219, 248, 146, 117, 126, 104, 231, 12, 214, 35, 212, 180, 2, 245, 252, 54, 37, 134, 33, 248, 165, 32, 253, 215, 178, 102, 205, 41, 83, 32, 158, 74, 98, 202, 32, 83, 73, 28, 49, 182, 57, 100, 64, 198, 77, 217, 245, 164, 190, 78, 27, 212, 139, 247, 224, 188, 91, 114, 247, 172, 147, 159, 237, 136, 78, 133, 152, 134, 18, 55, 245, 25, 63, 145, 239, 66, 115, 90, 149, 245, 84, 98, 172, 69, 174, 150, 115, 230, 89, 225, 60, 2, 157, 71, 253, 153, 188, 43, 98, 41, 178, 190, 191, 36, 119, 57, 0, 111, 2, 234, 50, 125, 201, 57, 38, 186, 17, 185, 228, 216, 55, 178, 207, 37, 78, 230, 50, 183, 83, 180, 247, 151, 37, 181, 103, 158, 105, 205, 72, 153, 59, 243, 159, 98, 221, 191, 218, 233, 233, 27, 218, 16, 59, 90, 131, 70, 222, 2, 253, 191, 180, 245, 154, 225, 157, 176, 216, 31, 140, 141, 241, 243, 110, 53, 246, 90, 234, 78, 63, 122, 87, 15, 13, 175, 75, 126, 148, 245, 253, 135, 216, 198, 51, 146, 248, 247, 144, 219, 53, 121, 7, 236, 85, 222, 157, 203, 46, 97, 9, 127, 3, 143, 194, 226, 140, 243, 183, 117, 3, 123, 107, 169, 121, 47, 220, 14, 109, 63, 124, 202, 91, 217, 173, 208, 245, 196, 38, 214, 251, 88, 187, 254, 12, 168, 125, 55, 16, 29, 246, 142, 246, 30, 103, 88, 249, 27, 28, 29, 193, 143, 199, 240, 171, 100, 239, 190, 222, 199, 174, 55, 235, 68, 231, 102, 104, 231, 0, 99, 250, 22, 22, 103, 1, 229, 118, 64, 31, 24, 110, 136, 109, 253, 46, 114, 102, 232, 108, 162, 141, 89, 232, 230, 98, 145, 212, 130, 125, 238, 223, 131, 87, 162, 231, 176, 22, 186, 239, 140, 243, 125, 118, 12, 5, 57, 167, 117, 54, 205, 103, 164, 212, 252, 215, 28, 234, 181, 244, 93, 236, 102, 234, 16, 53, 105, 18, 27, 7, 9, 232, 108, 36, 239, 179, 228, 249, 53, 180, 255, 136, 220, 115, 190, 189, 77, 244, 156, 238, 38, 246, 253, 126, 248, 237, 218, 179, 24, 183, 109, 127, 127, 221, 214, 246, 32, 31, 27, 239, 71, 111, 177, 38, 147, 164, 70, 90, 103, 167, 223, 77, 127, 37, 107, 101, 158, 134, 37, 44, 97, 9, 255, 3, 202, 19, 242, 235, 115, 237, 245, 9, 249, 254, 151, 192, 185, 235, 117, 124, 98, 243, 235, 69, 56, 252, 187, 231, 115, 50, 251, 3, 187, 63, 1, 233, 74, 233, 158, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 180, 232, 175, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 139, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129, 129 })
                );

        }

        private TcpListener? _tcp = null;

        public Action<PacketServerEmulatorAnswer>? EstablishConnectionAnswers = null;
        public readonly Dictionary<ushort, Action<PacketServerEmulatorAnswer>> ReceivePacketAnswers = new Dictionary<ushort, Action<PacketServerEmulatorAnswer>>();
        public List<ConnectionManager> Connections { get; } = new List<ConnectionManager>();

        public PacketServerEmulator OnReceivePacket(ushort type, Action<PacketServerEmulatorAnswer> answerCallback)
        {
            if (!GamePacketInfoRepository.Instance.ClientPackets.TryGetValue(type, out GamePacketInfo packetInfo))
                throw new ApplicationException($"Unknown packet type: {type}");

            if (ReceivePacketAnswers.ContainsKey(type))
                throw new ApplicationException($"Answer for {type} already registered");

            ReceivePacketAnswers.Add(type, answerCallback);

            return this;
        }

        public PacketServerEmulator OnEstablishConnection(Action<PacketServerEmulatorAnswer> answerCallback)
        {
            if (EstablishConnectionAnswers != null)
                throw new ApplicationException("Answer on establish connection already registered");

            EstablishConnectionAnswers = answerCallback;

            return this;
        }

        public void Start()
        {
            _tcp = new TcpListener(System.Net.IPAddress.Any, 8701);
            _tcp.Start();
            _tcp.BeginAcceptTcpClient(EstablishConnection, null);
            Console.ReadKey();
            _tcp.Stop();
        }

        private void EstablishConnection(IAsyncResult ar)
        {
            var connection = _tcp?.EndAcceptTcpClient(ar);
            if (connection == null) return;
            Connections.Add(new ConnectionManager(connection));
        }
    }

    public class ConnectionManager
    {
        private int PID = 0;
        private PacketInfo[] _extraPackets = Array.Empty<PacketInfo>();

        public TcpClient Connection { get; }

        public ConnectionManager(TcpClient connection)
        {
            Connection = connection;
            WaitToData();
        }

        public void WaitToData()
        {
            var rawBuffer = new byte[1024 * 8];
            Connection.Client.BeginReceive(rawBuffer, 0, rawBuffer.Length, SocketFlags.None, ReceiveData, rawBuffer);
        }

        private void ReceiveData(IAsyncResult ar)
        {
            var length = Connection.Client.EndReceive(ar);
            if (length == 0) return;
            var buffer = (byte[]?)ar.AsyncState ?? new byte[0];
            var data = new byte[length];
            Array.Copy(buffer, 0, data, 0, length);

            var packetInfo = new PacketInfo { PID = PID, Data = data, Source = 0 };
            var packetsInfo = new PacketInfo[_extraPackets.Length + 1];
            Array.Copy(_extraPackets, 0, packetsInfo, 0, _extraPackets.Length);
            packetsInfo[packetsInfo.Length - 1] = packetInfo;

            var parsedPackets = PacketInspectorService.ParseRawPackets(packetsInfo, out bool fullReaded);

            if (!fullReaded)
            {
                _extraPackets = packetsInfo;
                WaitToData();
                return;
            }

            _extraPackets = Array.Empty<PacketInfo>();

            foreach (var packet in parsedPackets)
            {
                if (!PacketServerEmulator.Instance.ReceivePacketAnswers.TryGetValue(packet.PacketInfo.Id, out var answerCallback))
                {
                    Console.WriteLine($"Client send packet id {packet.PacketInfo.Id}, but not implemented.");
                    continue;
                }
                else
                {
                    Console.WriteLine($"Received {packet.PacketInfo.Id}");
                }

                var answer = new PacketServerEmulatorAnswer(packet);
                answerCallback(answer);

                foreach (var reply in answer.Replies)
                {
                    if (!GamePacketInfoRepository.Instance.ServerPackets.TryGetValue(reply.Item1, out GamePacketInfo info))
                    {
                        Console.WriteLine($"You're sending a server packet {reply.Item1} unknown");
                        continue;
                    }
                    else
                    {
                        Console.WriteLine($"Sending {reply.Item1}");
                    }

                    var replyBuffer = new byte[info.Length == 0 ? (reply.Item2.Length + 4) : info.Length];
                    using (var ms = new MemoryStream(replyBuffer))
                    using (var bw = new BinaryWriter(ms))
                    {
                        bw.Write(info.Id);
                        if (info.Length == 0) bw.Write((ushort)(reply.Item2.Length + 4));
                        ms.Write(reply.Item2);
                    }

                    var isMasked = info.Id != 1002 && info.Id != 1001;

                    if (isMasked)
                        for (var b = 4; b < replyBuffer.Length; b++)
                            replyBuffer[b] ^= 129;

                    Connection.Client.Send(replyBuffer);
                }
            }

            PID++;

            WaitToData();
        }
    }


    public class PacketServerEmulatorAnswer
    {
        public PacketParsed Answer { get; }
        public List<Tuple<ushort, byte[]>> Replies = new List<Tuple<ushort, byte[]>>();

        public PacketServerEmulatorAnswer(PacketParsed packet)
        {
            Answer = packet;
        }

        public PacketServerEmulatorAnswer ReplyWith(ushort typeId, byte[] data)
        {
            Replies.Add(new Tuple<ushort, byte[]>(typeId, data));
            return this;
        }
    }
}
